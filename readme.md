# 作业检查与重命名系统 - 超简单使用指南

> 📚 专为老师设计的作业管理工具，一键检查谁没交作业，自动重命名学生文件

## 🎯 这个工具能帮你做什么？

### 主要功能
1. **自动检查作业** - 谁没交作业？一目了然
2. **智能重命名** - 学生文件乱命名？自动统一格式
3. **重复检测** - 谁重复提交了？马上知道
4. **报告生成** - 自动生成未交名单和重复名单

### 适合场景
- 收学生电子版作业
- 整理学生提交的文件
- 统计作业提交情况
- 统一文件命名规范

---

## 🚀 5分钟快速上手

### 第一步：运行软件
双击运行 `main.py`，看到这个界面：

```
作业检查与重命名系统
├── 花名册文件：[选择你的学生名单Excel]
├── 作业文件夹：[选择学生作业所在的文件夹]  
├── 输出目录：[选择报告保存位置]
└── 重命名格式：[选择命名规则]
```

### 第二步：生成示例文件（第一次使用必看！）

1. **找到示例文件生成工具**：
   - 在软件文件夹里找到 `示例文件生成.py`
   - 双击运行它

2. **生成示例文件**：
   - 程序会自动创建一个"正确示例文件"文件夹
   - 里面包含两个文件：
     - `格式模板.xlsx` - 命名规则模板
     - `花名册.xlsx` - 示例学生名单

3. **查看使用说明**：
   - 生成完成后会弹出详细的使用说明
   - 按照说明操作即可

### 第三步：开始使用
1. **一键检查** - 点击"开始检查"，自动生成报告
2. **只重命名** - 点击"仅重命名文件"，不检查只改名
3. **保存配置** - 点击"保存配置"，下次不用重新设置

---

## 📁 导入格式模板（老太太都能看懂版）

### 为什么要导入格式？
因为每个老师对文件命名要求不同，比如：
- `学号 姓名.docx`
- `姓名_课程_学号.pdf` 
- `班级_学号_姓名.zip`

通过导入格式模板，你可以自定义命名规则。

### 🧩 第一步：生成示例文件（已在上一步完成）

如果你还没生成示例文件，请先运行 `示例文件生成.py`

### 🧩 第二步：理解两个文件的作用

1. **格式模板.xlsx** - 告诉软件怎么命名文件
   - 包含各种命名规则
   - 比如：`{学号} {姓名}{扩展名}`

2. **花名册.xlsx** - 告诉软件学生信息
   - 包含学生学号、姓名等信息
   - 软件会读取这些信息来重命名

### 🧩 第三步：导入格式模板（看图操作）

1. 点击"**管理格式**"按钮
   ```
   [主界面] → 点击"管理格式"
   ```

2. 点击"**导入模板**"按钮
   ```
   [管理格式窗口] → 点击"导入模板"
   ```

3. **第一次选择文件**：
   - 找到"正确示例文件"文件夹
   - 选择 `格式模板.xlsx`
   - 点击"打开"

4. **第二次选择文件**：
   - 找到"正确示例文件"文件夹  
   - 选择 `花名册.xlsx`
   - 点击"打开"

5. **完成导入**：
   - 看到"导入成功"提示
   - 点击"确定"

### 🧩 第四步：使用你的格式

回到主界面，在"重命名格式"下拉菜单中：
- 选择你刚导入的格式
- 比如选择"标准格式"
- 然后点击"开始检查"

---

## 🆘 常见问题解答

### ❓ 导入时报错"缺少必需列"
**原因**：你选错文件了，选了花名册而不是格式模板
**解决**：第一次选择时要选`格式模板.xlsx`，不是`花名册.xlsx`

### ❓ 导入时报错"需要选择花名册文件"  
**原因**：你只选了格式模板，没选花名册
**解决**：第二次选择时要选`花名册.xlsx`

### ❓ 怎么知道选对文件了？
- 第一次选择：文件名应该是`格式模板.xlsx`
- 第二次选择：文件名应该是`花名册.xlsx`

### ❓ 重命名后出现"nan"
**原因**：花名册里某些信息是空的
**解决**：系统会自动用"_"代替，你也可以在花名册中补全信息

### ❓ 找不到学生文件
**原因**：文件名不包含学生姓名或学号
**解决**：确保文件名中有学生信息，如"张三作业.docx"或"20230001报告.pdf"

### ❓ 报告生成在哪里？
在你自己选择的"输出目录"里，文件名为：
- `未交作业名单_项目名称.xlsx`
- `重复提交名单_项目名称.xlsx`

---

## 🎨 格式模板创意示例

### 基础格式
```
{学号} {姓名}{扩展名}
→ 20230001 张三.docx
```

### 详细格式  
```
{姓名}_{班级}_{学号}{扩展名}
→ 张三_计算机1班_20230001.docx
```

### 课程相关格式
```
{姓名}_{课程名称}_{学号}{扩展名}  
→ 张三_区块链技术_20230001.docx
```

### 文件夹格式
```
{学号} {姓名}
→ 20230001 张三
```

---

## 💡 使用小贴士

### 批量处理多个项目
如果你的作业分多个文件夹（PROJECT1、PROJECT2等），可以：
1. 处理完PROJECT1后
2. 只修改"作业文件夹"为PROJECT2
3. 再次点击"开始检查"

### 智能重命名
系统会自动识别文件名中的学生信息，支持：
- 文件名包含姓名：`张三_作业.docx`
- 文件名包含学号：`20230001_报告.pdf`  
- 文件名混合：`区块链_张三_项目.zip`

### 特殊项目处理
- **PROJECT4**：这是文件夹项目，记得在格式中设置"是否文件夹"为TRUE
- **PROJECT3**：有特殊命名规则，可以使用预设的PROJECT3格式

---

## 📞 获取帮助

如果遇到问题：
1. **先看这个指南** - 90%的问题这里都有答案
2. **检查文件格式** - 确保花名册有"学号"和"姓名"列
3. **查看程序日志** - 程序下方的文本框会显示详细过程

记住：第一次使用可能会觉得复杂，但用一次就会了！大多数老师只需要设置一次格式，以后就可以一直使用了。

---

## 🎯 总结使用流程

1. **准备**：运行`示例文件生成.py`生成示例文件
2. **设置**：按照"导入格式模板"步骤操作
3. **使用**：选择文件 → 开始检查 → 查看报告

**真的不难！就像用微信发文件一样简单！** 🎉

---

## 🆕 更新说明

### 最新改进
- ✅ 空值自动显示为"_"而不是"nan"
- ✅ 更清晰的错误提示
- ✅ 更简单的示例文件生成

### 文件说明
- `main.py` - 主程序，双击运行
- `示例文件生成.py` - 示例文件生成工具
- `config/` - 配置文件（自动生成）
- `core/` - 核心程序文件
- `templates/` - 模板文件

---

*最后更新：2024年1月 | 如有问题，请检查上述步骤或重新阅读指南*